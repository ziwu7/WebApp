function e(e,t,a,r){Object.defineProperty(e,t,{get:a,set:r,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire951b,a=t.register;a("ibzHP",function(a,r){let n,i,o,s,l,c,d,u,f,p,m;Object.defineProperty(a.exports,"__esModule",{value:!0,configurable:!0}),e(a.exports,"default",function(){return A});var h,y,b,g,v=t("4hKGQ"),w=t("UM4Ri"),x=t("kelqU"),F=t("N2Qqw"),j=t("3gwHm"),O=t("40kHK"),k=t("8myCc"),S=t("6P9EB"),T=t("lFp0N"),E=function(e,t,a,r,n,i){function o(e){if(void 0!==e&&"function"!=typeof e)throw TypeError("Function expected");return e}for(var s,l=r.kind,c="getter"===l?"get":"setter"===l?"set":"value",d=!t&&e?r.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,r.name):{}),f=!1,p=a.length-1;p>=0;p--){var m={};for(var h in r)m[h]="access"===h?{}:r[h];for(var h in r.access)m.access[h]=r.access[h];m.addInitializer=function(e){if(f)throw TypeError("Cannot add initializers after decoration has completed");i.push(o(e||null))};var y=(0,a[p])("accessor"===l?{get:u.get,set:u.set}:u[c],m);if("accessor"===l){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw TypeError("Object expected");(s=o(y.get))&&(u.get=s),(s=o(y.set))&&(u.set=s),(s=o(y.init))&&n.unshift(s)}else(s=o(y))&&("field"===l?n.unshift(s):u[c]=s)}d&&Object.defineProperty(d,r.name,u),f=!0},I=function(e,t,a){for(var r=arguments.length>2,n=0;n<t.length;n++)a=r?t[n].call(e,a):t[n].call(e);return r?a:void 0},P=function(e,t,a,r){return new(a||(a=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(o,s)}l((r=r.apply(e,t||[])).next())})},H=function(e,t,a,r){if("a"===a&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)},C=function(e,t,a,r,n){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?n.call(e,a):n?n.value=a:t.set(e,a),a},M=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)0>t.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(a[r[n]]=e[r[n]]);return a},A=(l=[(0,w.component)({tagName:"factory-edit"}),w.observer],c=[],d=HTMLElement,u=[],f=[],p=[],m=[],i=class extends d{constructor(){super(...arguments),h.set(this,I(this,u,"")),y.set(this,(I(this,f),I(this,p,{name:"",province:"",city:"",district:"",address:"",qualification:"",coords:{},url:"",supplies:S.default,contacts:[{}],remark:""}))),Object.defineProperty(this,"changeText",{enumerable:!0,configurable:!0,writable:!0,value:(I(this,m),({target:e})=>{let{name:t,value:a}=e;this.state=Object.assign(Object.assign({},this.state),{[t]:a})})}),Object.defineProperty(this,"changeAddress",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t=e.detail,{latitude:a,longitude:r}=t,n=M(t,["latitude","longitude"]);return Object.assign(this.state,Object.assign(Object.assign({},n),{coords:{latitude:a,longitude:r}}))}}),Object.defineProperty(this,"handleSubmit",{enumerable:!0,configurable:!0,writable:!0,value:e=>P(this,void 0,void 0,function*(){e.preventDefault();let t=this.state,{supplies:a,contacts:r}=t,n=M(t,["supplies","contacts"]);yield(0,O.factory).updateOne(Object.assign(Object.assign({},n),{supplies:a.filter(({count:e})=>e),contacts:r.filter(({name:e,phone:t})=>(null==e?void 0:e.trim())&&(null==t?void 0:t.trim()))}),this.dataId),self.alert("提交成功，工作人员审核后即可查看"),location.hash=k.RouteRoot.Factory})})}get dataId(){return H(this,h,"f")}set dataId(e){C(this,h,e,"f")}get state(){return H(this,y,"f")}set state(e){C(this,y,e,"f")}mountedCallback(){return P(this,void 0,void 0,function*(){if(!this.dataId)return;let{name:e,qualification:t,province:a,city:r,district:n,address:i,coords:o,url:s,supplies:l,contacts:c,remark:d}=yield(0,O.factory).getOne(this.dataId);this.state={name:e,qualification:t,province:a,city:r,district:n,address:i,coords:o,url:s,supplies:(0,j.mergeList)("name",this.state.supplies,l),contacts:c,remark:d}})}render(){let{name:e,qualification:t,province:a,city:r,district:n,address:i,url:o,supplies:s,contacts:l,remark:c}=this.state;return(0,v.jsxs)(T.SessionBox,{children:[(0,v.jsx)("h2",{children:"生产厂商发布"}),(0,v.jsxs)("form",{onChange:this.changeText,onSubmit:this.handleSubmit,children:[(0,v.jsx)(x.FormField,{name:"name",required:!0,defaultValue:e,label:"厂商名字"}),(0,v.jsxs)(x.FormGroup,{children:[(0,v.jsx)(x.FormLabel,{children:"机构地址"}),(0,v.jsx)(T.AddressField,{place:e,province:a,city:r,district:n,address:i,onChange:this.changeAddress})]}),(0,v.jsx)(x.FormField,{type:"url",name:"url",required:!0,defaultValue:o,label:"官方网址"}),(0,v.jsx)(x.FormField,{name:"qualification",required:!0,defaultValue:t,label:"资质证明"}),(0,v.jsx)(T.SuppliesField,{list:s,onChange:({detail:e})=>this.state.supplies=e}),(0,v.jsx)(T.ContactField,{list:l,onChange:({detail:e})=>this.state.contacts=e}),(0,v.jsx)(x.FormField,{as:"textarea",name:"remark",label:"备注",defaultValue:c}),(0,v.jsxs)(x.FormGroup,{className:"mt-3 d-flex flex-column",children:[(0,v.jsx)(x.Button,{type:"submit",variant:"primary",disabled:O.factory.uploading>0,children:"提交"}),(0,v.jsx)(x.Button,{type:"reset",variant:"danger",onClick:()=>location.hash=k.RouteRoot.Factory,children:"取消"})]})]})]})}},h=new WeakMap,y=new WeakMap,b=i,"symbol"==typeof(g="FactoryEdit")&&(g=g.description?"[".concat(g.description,"]"):""),Object.defineProperty(b,"name",{configurable:!0,value:g}),(()=>{var e;let t="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(e=d[Symbol.metadata])&&void 0!==e?e:null):void 0;o=[w.attribute,F.observable],s=[F.observable],E(i,null,o,{kind:"accessor",name:"dataId",static:!1,private:!1,access:{has:e=>"dataId"in e,get:e=>e.dataId,set:(e,t)=>{e.dataId=t}},metadata:t},u,f),E(i,null,s,{kind:"accessor",name:"state",static:!1,private:!1,access:{has:e=>"state"in e,get:e=>e.state,set:(e,t)=>{e.state=t}},metadata:t},p,m),E(null,n={value:i},l,{kind:"class",name:i.name,metadata:t},null,c),i=n.value,t&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t}),I(i,c)})(),i)}),a("8myCc",function(t,a){e(t.exports,"RouteRoot",function(){return n}),e(t.exports,"default",function(){return i}),(r=n||(n={})).Hospital="hospital",r.Logistics="logistics",r.Hotel="hotel",r.Factory="factory",r.Donation="donation",r.Clinic="clinic",r.Maps="maps",r.Admin="admin",r.Community="community";var r,n,i=[{title:"首页",href:""},{title:"医院",href:n.Hospital,icon:"hospital"},{title:"物流",href:n.Logistics,icon:"truck"},{title:"酒店",href:n.Hotel,icon:"building-check"},{title:"生产",href:n.Factory,icon:"buildings"},{title:"捐赠",href:n.Donation,icon:"heart"},{title:"义诊",href:n.Clinic,icon:"house-heart"},{title:"疫情地图",href:n.Maps,icon:"map"},{title:"红会监工",href:"https://weileizeng.github.io/red-cross/",icon:"plus-square"},{title:"开放社区",href:n.Community}]}),a("6P9EB",function(t,a){e(t.exports,"default",function(){return r});var r=[{name:"普通医用口罩",type:"face",remark:"YY/T 0969-2013"},{name:"医用外科口罩",type:"face",remark:"YY/T 0469-2010"},{name:"医用防护口罩|N95口罩",type:"face",remark:"GB 19083-2010，建议3M 1860/1870/9123，防飞沫血液体液款"},{name:"防冲击眼罩/护目镜/防护眼镜",type:"face"},{name:"防护面罩",type:"face"},{name:"防护帽/医用帽/圆帽",type:"other"},{name:"隔离衣",type:"other"},{name:"防护服",type:"other",remark:"GB 19082-2003"},{name:"手术衣",type:"other"},{name:"乳胶手套",type:"other",remark:"灭菌，GB 10213-2006"},{name:"长筒胶鞋/防污染靴",type:"leg"},{name:"防污染鞋套",type:"leg"},{name:"防污染靴套",type:"leg"},{name:"84消毒液",type:"disinfection"},{name:"过氧乙酸",type:"disinfection"},{name:"75%酒精",type:"disinfection"},{name:"手部皮肤消毒液",type:"disinfection"},{name:"活力碘",type:"disinfection"},{name:"床罩",type:"other"},{name:"医用面罩式雾化器",type:"other"},{name:"测体温设备",type:"device"},{name:"空气消毒设备",type:"device",remark:"医疗器械注册证"},{name:"空气紫外线消毒车",type:"device",remark:"医疗器械注册证"}]}),a("i2xD3",function(a,r){e(a.exports,"errors",function(){return n}),e(a.exports,"config",function(){return i}),e(a.exports,"fromDataTransfer",function(){return o}),e(a.exports,"getDirHandlesFromInput",function(){return s}),e(a.exports,"getFileHandlesFromInput",function(){return l});let n={INVALID:["seeking position failed.","InvalidStateError"],GONE:["A requested file or directory could not be found at the time an operation was processed.","NotFoundError"],MISMATCH:["The path supplied exists, but was not an entry of requested type.","TypeMismatchError"],MOD_ERR:["The object can not be modified in this way.","InvalidModificationError"],SYNTAX:e=>[`Failed to execute 'write' on 'UnderlyingSinkBase': Invalid params passed. ${e}`,"SyntaxError"],SECURITY:["It was determined that certain files are unsafe for access within a Web application, or that too many calls are being made on file resources.","SecurityError"],DISALLOWED:["The request is not allowed by the user agent or the platform in the current context.","NotAllowedError"]},i={writable:globalThis.WritableStream};async function o(e){console.warn("deprecated fromDataTransfer - use `dt.items[0].getAsFileSystemHandle()` instead");let[a,r,n]=await Promise.all([t("5kIpF"),t("83aam"),t("9FMAP")]),i=new a.FolderHandle("",!1);return i._entries=e.map(e=>e.isFile?new r.FileHandle(e,!1):new r.FolderHandle(e,!1)),new n.FileSystemDirectoryHandle(i)}async function s(e){let{FolderHandle:a,FileHandle:r}=await t("5kIpF"),{FileSystemDirectoryHandle:n}=await t("9FMAP"),i=Array.from(e.files),o=new a(i[0].webkitRelativePath.split("/",1)[0],!1);return i.forEach(e=>{let t=e.webkitRelativePath.split("/");t.shift();let n=t.pop();t.reduce((e,t)=>(e._entries[t]||(e._entries[t]=new a(t,!1)),e._entries[t]),o)._entries[n]=new r(e.name,e,!1)}),new n(o)}async function l(e){let{FileHandle:a}=await t("5kIpF"),{FileSystemFileHandle:r}=await t("5dHz8");return Array.from(e.files).map(e=>new r(new a(e.name,e,!1)))}}),a("5kIpF",function(e,a){var r=t("az5d3");e.exports=r("5tuHl").then(()=>t("dtpmZ"))}),a("az5d3",function(e,a){e.exports=function(e){return import(t("itrNZ").resolve(e))}}),a("itrNZ",function(t,a){e(t.exports,"register",function(){return r},function(e){return r=e}),e(t.exports,"resolve",function(){return n},function(e){return n=e});var r,n,i=new Map;r=function(e,t){for(var a=0;a<t.length-1;a+=2)i.set(t[a],{baseUrl:e,path:t[a+1]})},n=function(e){var t=i.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),a("83aam",function(e,a){var r=t("az5d3");e.exports=r("d0xkQ").then(()=>t("d1xSi"))}),a("9FMAP",function(e,a){var r=t("az5d3");e.exports=r("e8ZAS").then(()=>t("9eWHj"))}),a("5dHz8",function(e,a){var r=t("az5d3");e.exports=r("8dN6x").then(()=>t("kcPVa"))}),a("7fsxx",function(t,a){e(t.exports,"default",function(){return r});var r={ReadableStream:globalThis.ReadableStream,WritableStream:globalThis.WritableStream,TransformStream:globalThis.TransformStream,DOMException:globalThis.DOMException,Blob:globalThis.Blob,File:globalThis.File}});