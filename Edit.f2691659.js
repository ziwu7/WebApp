!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire951b,n=t.register;n("62U0s",function(n,r){Object.defineProperty(n.exports,"__esModule",{value:!0,configurable:!0}),e(n.exports,"default",function(){return z});var a,i,o,s,l,c,u,f,d,p,h,m,y,b,v,g,w,x=t("gV4k2"),k=t("I2P72"),T=t("iEu77"),j=t("9bYAk"),E=t("gdLkz"),F=t("7tQZq"),_=t("dMn7r"),O=t("fkswq"),S=t("iDlJk"),C=t("ksXWa"),I=t("9RkJG"),H=t("azEil"),P=t("bNNon"),M=t("fmkUX"),R=t("aQIVs"),q=t("912gW"),D=t("jcToA"),N=function(e,t,n,r,a,i){function o(e){if(void 0!==e&&"function"!=typeof e)throw TypeError("Function expected");return e}for(var s,l=r.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?r.static?e:e.prototype:null,f=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),d=!1,p=n.length-1;p>=0;p--){var h={};for(var m in r)h[m]="access"===m?{}:r[m];for(var m in r.access)h.access[m]=r.access[m];h.addInitializer=function(e){if(d)throw TypeError("Cannot add initializers after decoration has completed");i.push(o(e||null))};var y=(0,n[p])("accessor"===l?{get:f.get,set:f.set}:f[c],h);if("accessor"===l){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw TypeError("Object expected");(s=o(y.get))&&(f.get=s),(s=o(y.set))&&(f.set=s),(s=o(y.init))&&a.unshift(s)}else(s=o(y))&&("field"===l?a.unshift(s):f[c]=s)}u&&Object.defineProperty(u,r.name,f),d=!0},A=function(e,t,n){for(var r=arguments.length>2,a=0;a<t.length;a++)n=r?t[a].call(e,n):t[a].call(e);return r?n:void 0},W=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}l((r=r.apply(e,t||[])).next())})},B=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},L=function(e,t,n,r,a){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!a)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},V=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)0>t.indexOf(r[a])&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},z=(u=[(0,C.component)({tagName:"hospital-edit"}),C.observer],f=[],p=[],h=[],m=[],y=[],s=function(e){(0,E._)(n,e);var t=(0,_._)(n);function n(){var e;return(0,k._)(this,n),e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),a.set((0,x._)(e),A((0,x._)(e),p,"")),i.set((0,x._)(e),(A((0,x._)(e),h),A((0,x._)(e),m,{hospital:"",province:"",city:"",district:"",address:"",coords:{},url:"",supplies:R.default,contacts:[{}],remark:""}))),Object.defineProperty((0,x._)(e),"changeText",{enumerable:!0,configurable:!0,writable:!0,value:(A((0,x._)(e),y),function(t){var n=t.target,r=n.name,a=n.value;e.state=Object.assign(Object.assign({},e.state),(0,j._)({},r,a))})}),Object.defineProperty((0,x._)(e),"changeAddress",{enumerable:!0,configurable:!0,writable:!0,value:function(t){var n=t.detail,r=n.latitude,a=n.longitude,i=V(n,["latitude","longitude"]);return Object.assign(e.state,Object.assign(Object.assign({},i),{coords:{latitude:r,longitude:a}}))}}),Object.defineProperty((0,x._)(e),"handleSubmit",{enumerable:!0,configurable:!0,writable:!0,value:function(t){return W((0,x._)(e),void 0,void 0,function(){var e,n,r,a;return(0,O.__generator)(this,function(i){switch(i.label){case 0:return t.preventDefault(),n=(e=this.state).supplies,r=e.contacts,a=V(e,["supplies","contacts"]),[4,(0,q.suppliesRequirement).updateOne(Object.assign(Object.assign({},a),{supplies:n.filter(function(e){return e.count}),contacts:r.filter(function(e){var t=e.name,n=e.phone;return(null==t?void 0:t.trim())&&(null==n?void 0:n.trim())})}),this.dataId)];case 1:return i.sent(),self.alert("提交成功，工作人员审核后即可查看"),location.hash=M.RouteRoot.Hospital,[2]}})})}}),e}return(0,T._)(n,[{key:"dataId",get:function(){return B(this,a,"f")},set:function(e){L(this,a,e,"f")}},{key:"state",get:function(){return B(this,i,"f")},set:function(e){L(this,i,e,"f")}},{key:"mountedCallback",value:function(){return W(this,void 0,void 0,function(){var e,t,n,r,a,i,o,s,l,c,u;return(0,O.__generator)(this,function(f){switch(f.label){case 0:if(!this.dataId)return[2];return[4,(0,q.suppliesRequirement).getOne(this.dataId)];case 1:return t=(e=f.sent()).hospital,n=e.province,r=e.city,a=e.district,i=e.address,o=e.coords,s=e.url,l=e.supplies,c=e.contacts,u=e.remark,this.state={hospital:t,province:n,city:r,district:a,address:i,coords:o,url:s,supplies:(0,P.mergeList)("name",this.state.supplies,l),contacts:c,remark:u},[2]}})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.hospital,r=t.province,a=t.city,i=t.district,o=t.address,s=t.url,l=t.supplies,c=t.contacts,u=t.remark;return(0,S.jsxs)(D.SessionBox,{children:[(0,S.jsx)("h1",{children:"医用物资需求发布"}),(0,S.jsxs)("form",{onChange:this.changeText,onSubmit:this.handleSubmit,children:[(0,S.jsx)(I.FormField,{name:"hospital",required:!0,defaultValue:n,label:"医疗机构",placeholder:"可详细至分院、院区、科室"}),(0,S.jsx)(I.FormField,{label:"机构地址",children:(0,S.jsx)(D.AddressField,{place:n,province:r,city:a,district:i,address:o,onChange:this.changeAddress})}),(0,S.jsx)(I.FormField,{type:"url",name:"url",required:!0,defaultValue:s,label:"官方网址"}),(0,S.jsx)(D.SuppliesField,{list:l,onChange:function(t){var n=t.detail;return e.state.supplies=n}}),(0,S.jsx)(D.ContactField,{list:c,onChange:function(t){var n=t.detail;return e.state.contacts=n}}),(0,S.jsx)(I.FormField,{is:"textarea",name:"remark",label:"备注",defaultValue:u}),(0,S.jsxs)(I.FormGroup,{className:"mt-3 d-flex flex-column",children:[(0,S.jsx)(I.Button,{type:"submit",variant:"primary",disabled:q.suppliesRequirement.uploading>0,children:"提交"}),(0,S.jsx)(I.Button,{type:"reset",variant:"danger",onClick:function(){return location.hash=M.RouteRoot.Hospital},children:"取消"})]})]})]})}}]),n}(d=HTMLElement),a=new WeakMap,i=new WeakMap,b=s,v="HospitalEdit","symbol"===(0,F._)(v)&&(v=v.description?"[".concat(v.description,"]"):""),Object.defineProperty(b,"name",{configurable:!0,value:v}),w="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(g=d[Symbol.metadata])&&void 0!==g?g:null):void 0,l=[C.attribute,H.observable],c=[H.observable],N(s,null,l,{kind:"accessor",name:"dataId",static:!1,private:!1,access:{has:function(e){return"dataId"in e},get:function(e){return e.dataId},set:function(e,t){e.dataId=t}},metadata:w},p,h),N(s,null,c,{kind:"accessor",name:"state",static:!1,private:!1,access:{has:function(e){return"state"in e},get:function(e){return e.state},set:function(e,t){e.state=t}},metadata:w},m,y),N(null,o={value:s},u,{kind:"class",name:s.name,metadata:w},null,f),s=o.value,w&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:w}),A(s,f),s)}),n("fmkUX",function(t,n){e(t.exports,"RouteRoot",function(){return a}),e(t.exports,"default",function(){return i}),(r=a||(a={})).Hospital="hospital",r.Logistics="logistics",r.Hotel="hotel",r.Factory="factory",r.Donation="donation",r.Clinic="clinic",r.Maps="maps",r.Admin="admin",r.Community="community";var r,a,i=[{title:"首页",href:""},{title:"医院",href:a.Hospital,icon:"hospital"},{title:"物流",href:a.Logistics,icon:"truck"},{title:"酒店",href:a.Hotel,icon:"building-check"},{title:"生产",href:a.Factory,icon:"buildings"},{title:"捐赠",href:a.Donation,icon:"heart"},{title:"义诊",href:a.Clinic,icon:"house-heart"},{title:"疫情地图",href:a.Maps,icon:"map"},{title:"红会监工",href:"https://weileizeng.github.io/red-cross/",icon:"plus-square"},{title:"开放社区",href:a.Community}]}),n("aQIVs",function(t,n){e(t.exports,"default",function(){return r});var r=[{name:"普通医用口罩",type:"face",remark:"YY/T 0969-2013"},{name:"医用外科口罩",type:"face",remark:"YY/T 0469-2010"},{name:"医用防护口罩|N95口罩",type:"face",remark:"GB 19083-2010，建议3M 1860/1870/9123，防飞沫血液体液款"},{name:"防冲击眼罩/护目镜/防护眼镜",type:"face"},{name:"防护面罩",type:"face"},{name:"防护帽/医用帽/圆帽",type:"other"},{name:"隔离衣",type:"other"},{name:"防护服",type:"other",remark:"GB 19082-2003"},{name:"手术衣",type:"other"},{name:"乳胶手套",type:"other",remark:"灭菌，GB 10213-2006"},{name:"长筒胶鞋/防污染靴",type:"leg"},{name:"防污染鞋套",type:"leg"},{name:"防污染靴套",type:"leg"},{name:"84消毒液",type:"disinfection"},{name:"过氧乙酸",type:"disinfection"},{name:"75%酒精",type:"disinfection"},{name:"手部皮肤消毒液",type:"disinfection"},{name:"活力碘",type:"disinfection"},{name:"床罩",type:"other"},{name:"医用面罩式雾化器",type:"other"},{name:"测体温设备",type:"device"},{name:"空气消毒设备",type:"device",remark:"医疗器械注册证"},{name:"空气紫外线消毒车",type:"device",remark:"医疗器械注册证"}]}),n("gKVDL",function(n,r){e(n.exports,"errors",function(){return s}),e(n.exports,"config",function(){return l}),e(n.exports,"fromDataTransfer",function(){return c}),e(n.exports,"getDirHandlesFromInput",function(){return f}),e(n.exports,"getFileHandlesFromInput",function(){return p});var a=t("7eVHo"),i=t("72bWt"),o=t("fkswq"),s={INVALID:["seeking position failed.","InvalidStateError"],GONE:["A requested file or directory could not be found at the time an operation was processed.","NotFoundError"],MISMATCH:["The path supplied exists, but was not an entry of requested type.","TypeMismatchError"],MOD_ERR:["The object can not be modified in this way.","InvalidModificationError"],SYNTAX:function(e){return["Failed to execute 'write' on 'UnderlyingSinkBase': Invalid params passed. ".concat(e),"SyntaxError"]},SECURITY:["It was determined that certain files are unsafe for access within a Web application, or that too many calls are being made on file resources.","SecurityError"],DISALLOWED:["The request is not allowed by the user agent or the platform in the current context.","NotAllowedError"]},l={writable:globalThis.WritableStream};function c(e){return u.apply(this,arguments)}function u(){return(u=(0,a._)(function(e){var n,r,a,s,l;return(0,o.__generator)(this,function(o){switch(o.label){case 0:return console.warn("deprecated fromDataTransfer - use `dt.items[0].getAsFileSystemHandle()` instead"),[4,Promise.all([t("lWSaf"),t("9mM6W"),t("7sfzw")])];case 1:return r=(n=(0,i._).apply(void 0,[o.sent(),3]))[0],a=n[1],s=n[2],(l=new r.FolderHandle("",!1))._entries=e.map(function(e){return e.isFile?new a.FileHandle(e,!1):new a.FolderHandle(e,!1)}),[2,new s.FileSystemDirectoryHandle(l)]}})})).apply(this,arguments)}function f(e){return d.apply(this,arguments)}function d(){return(d=(0,a._)(function(e){var n,r,a,i,s,l,c;return(0,o.__generator)(this,function(o){switch(o.label){case 0:return[4,t("lWSaf")];case 1:return r=(n=o.sent()).FolderHandle,a=n.FileHandle,[4,t("7sfzw")];case 2:return i=o.sent().FileSystemDirectoryHandle,l=(s=Array.from(e.files))[0].webkitRelativePath.split("/",1)[0],c=new r(l,!1),s.forEach(function(e){var t=e.webkitRelativePath.split("/");t.shift();var n=t.pop();t.reduce(function(e,t){return e._entries[t]||(e._entries[t]=new r(t,!1)),e._entries[t]},c)._entries[n]=new a(e.name,e,!1)}),[2,new i(c)]}})})).apply(this,arguments)}function p(e){return h.apply(this,arguments)}function h(){return(h=(0,a._)(function(e){var n,r;return(0,o.__generator)(this,function(a){switch(a.label){case 0:return[4,t("lWSaf")];case 1:return n=a.sent().FileHandle,[4,t("7ifET")];case 2:return r=a.sent().FileSystemFileHandle,[2,Array.from(e.files).map(function(e){return new r(new n(e.name,e,!1))})]}})})).apply(this,arguments)}}),n("lWSaf",function(e,n){e.exports=t("c3Nfi")(t("kC3Tq").resolve("ecOdP")).then(function(){return t("7MvC9")})}),n("c3Nfi",function(e,n){var r=t("9EbbF");e.exports=r(function(e){return new Promise(function(t,n){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e})){t();return}var r=document.createElement("link");r.href=e,r.rel="preload",r.as="script",document.head.appendChild(r);var a=document.createElement("script");a.async=!0,a.type="text/javascript",a.src=e,a.onerror=function(t){var r=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));a.onerror=a.onload=null,a.remove(),n(r)},a.onload=function(){a.onerror=a.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(a)})})}),n("9EbbF",function(e,t){var n={},r={},a={};e.exports=function(e,t){return function(i){var o=function(e){switch(e){case"preload":return r;case"prefetch":return a;default:return n}}(t);return o[i]?o[i]:o[i]=e.apply(null,arguments).catch(function(e){throw delete o[i],e})}}}),n("kC3Tq",function(t,n){e(t.exports,"register",function(){return r},function(e){return r=e}),e(t.exports,"resolve",function(){return a},function(e){return a=e});var r,a,i=new Map;r=function(e,t){for(var n=0;n<t.length-1;n+=2)i.set(t[n],{baseUrl:e,path:t[n+1]})},a=function(e){var t=i.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),n("9mM6W",function(e,n){e.exports=t("c3Nfi")(t("kC3Tq").resolve("3KEM7")).then(function(){return t("2wF3H")})}),n("7sfzw",function(e,n){e.exports=t("c3Nfi")(t("kC3Tq").resolve("9FPx2")).then(function(){return t("5yJoG")})}),n("7ifET",function(e,n){e.exports=t("c3Nfi")(t("kC3Tq").resolve("7hTL1")).then(function(){return t("42yKc")})}),n("jr756",function(t,n){e(t.exports,"default",function(){return r});var r={ReadableStream:globalThis.ReadableStream,WritableStream:globalThis.WritableStream,TransformStream:globalThis.TransformStream,DOMException:globalThis.DOMException,Blob:globalThis.Blob,File:globalThis.File}})}();